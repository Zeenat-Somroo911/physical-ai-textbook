"use strict";(globalThis.webpackChunkphysical_ai_textbook=globalThis.webpackChunkphysical_ai_textbook||[]).push([[4389],{5751:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"module-02-simulation/physics-simulation","title":"Chapter 3: Physics Simulation","description":"Physics Engines Comparison","source":"@site/docs/module-02-simulation/03-physics-simulation.md","sourceDirName":"module-02-simulation","slug":"/module-02-simulation/physics-simulation","permalink":"/physical-ai-textbook/docs/module-02-simulation/physics-simulation","draft":false,"unlisted":false,"editUrl":"https://github.com/Zeenat-Somroo911/physical-ai-textbook/edit/main/docs/module-02-simulation/03-physics-simulation.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 2: URDF vs SDF","permalink":"/physical-ai-textbook/docs/module-02-simulation/urdf-sdf"},"next":{"title":"Chapter 4: Sensor Simulation","permalink":"/physical-ai-textbook/docs/module-02-simulation/sensor-simulation"}}');var r=i(4848),l=i(8453);const t={sidebar_position:3},c="Chapter 3: Physics Simulation",o={},a=[{value:"Physics Engines Comparison",id:"physics-engines-comparison",level:2},{value:"Available Physics Engines",id:"available-physics-engines",level:3},{value:"ODE (Open Dynamics Engine)",id:"ode-open-dynamics-engine",level:3},{value:"Bullet Physics",id:"bullet-physics",level:3},{value:"Simbody",id:"simbody",level:3},{value:"Choosing the Right Engine",id:"choosing-the-right-engine",level:3},{value:"Gravity Configuration",id:"gravity-configuration",level:2},{value:"Setting Gravity",id:"setting-gravity",level:3},{value:"Gravity in Different Environments",id:"gravity-in-different-environments",level:3},{value:"Per-Link Gravity Control",id:"per-link-gravity-control",level:3},{value:"Friction and Contact",id:"friction-and-contact",level:2},{value:"Friction Configuration",id:"friction-configuration",level:3},{value:"Common Friction Coefficients",id:"common-friction-coefficients",level:3},{value:"Friction Example",id:"friction-example",level:3},{value:"Mass and Inertia",id:"mass-and-inertia",level:2},{value:"Mass Definition",id:"mass-definition",level:3},{value:"Inertia Matrix",id:"inertia-matrix",level:3},{value:"Calculating Inertia",id:"calculating-inertia",level:3},{value:"Inertia Example",id:"inertia-example",level:3},{value:"Center of Mass",id:"center-of-mass",level:3},{value:"Physics Parameters",id:"physics-parameters",level:2},{value:"Step Size",id:"step-size",level:3},{value:"Real-Time Factor",id:"real-time-factor",level:3},{value:"Solver Parameters (ODE)",id:"solver-parameters-ode",level:3},{value:"Debugging Physics",id:"debugging-physics",level:2},{value:"Common Physics Issues",id:"common-physics-issues",level:3},{value:"Issue 1: Objects Penetrating",id:"issue-1-objects-penetrating",level:4},{value:"Issue 2: Jittery Motion",id:"issue-2-jittery-motion",level:4},{value:"Issue 3: Objects Flying Away",id:"issue-3-objects-flying-away",level:4},{value:"Issue 4: Slow Simulation",id:"issue-4-slow-simulation",level:4},{value:"Physics Debug Visualization",id:"physics-debug-visualization",level:3},{value:"Monitoring Physics",id:"monitoring-physics",level:3},{value:"Performance Tips",id:"performance-tips",level:2},{value:"1. Optimize Collision Geometries",id:"1-optimize-collision-geometries",level:3},{value:"2. Use Appropriate Step Size",id:"2-use-appropriate-step-size",level:3},{value:"3. Limit Solver Iterations",id:"3-limit-solver-iterations",level:3},{value:"4. Simplify Models",id:"4-simplify-models",level:3},{value:"5. Use Static Objects",id:"5-use-static-objects",level:3},{value:"6. Optimize Contact Detection",id:"6-optimize-contact-detection",level:3},{value:"Complete Physics Configuration Example",id:"complete-physics-configuration-example",level:2},{value:"Common Pitfalls",id:"common-pitfalls",level:2},{value:"Pitfall 1: Unrealistic Mass Values",id:"pitfall-1-unrealistic-mass-values",level:3},{value:"Pitfall 2: Incorrect Inertia",id:"pitfall-2-incorrect-inertia",level:3},{value:"Pitfall 3: Too Small Step Size",id:"pitfall-3-too-small-step-size",level:3},{value:"Pitfall 4: Missing Friction",id:"pitfall-4-missing-friction",level:3},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"chapter-3-physics-simulation",children:"Chapter 3: Physics Simulation"})}),"\n",(0,r.jsx)(n.h2,{id:"physics-engines-comparison",children:"Physics Engines Comparison"}),"\n",(0,r.jsx)(n.p,{children:"Gazebo supports multiple physics engines, each with different characteristics. Understanding which engine to use for your simulation is crucial for accuracy and performance."}),"\n",(0,r.jsx)(n.h3,{id:"available-physics-engines",children:"Available Physics Engines"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-mermaid",children:"graph TB\r\n    A[Physics Engine] --\x3e B[ODE]\r\n    A --\x3e C[Bullet]\r\n    A --\x3e D[Simbody]\r\n    \r\n    B --\x3e B1[Default]\r\n    B --\x3e B2[Well-tested]\r\n    B --\x3e B3[Good performance]\r\n    \r\n    C --\x3e C1[Complex collisions]\r\n    C --\x3e C2[Better for soft bodies]\r\n    \r\n    D --\x3e D1[Most accurate]\r\n    D --\x3e D2[Slower]\r\n    \r\n    style B fill:#c8e6c9\r\n    style C fill:#fff9c4\r\n    style D fill:#ffccbc\n"})}),"\n",(0,r.jsx)(n.h3,{id:"ode-open-dynamics-engine",children:"ODE (Open Dynamics Engine)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Default engine in Gazebo"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pros"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Well-tested and stable"}),"\n",(0,r.jsx)(n.li,{children:"Good performance"}),"\n",(0,r.jsx)(n.li,{children:"Extensive documentation"}),"\n",(0,r.jsx)(n.li,{children:"Default choice for most simulations"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cons"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Can have issues with complex contacts"}),"\n",(0,r.jsx)(n.li,{children:"Less accurate for some scenarios"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Best For"}),": General-purpose robotics simulation"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"bullet-physics",children:"Bullet Physics"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Alternative engine with better collision handling"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pros"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Better handling of complex collisions"}),"\n",(0,r.jsx)(n.li,{children:"Good for soft bodies"}),"\n",(0,r.jsx)(n.li,{children:"More stable contact resolution"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cons"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Slightly slower than ODE"}),"\n",(0,r.jsx)(n.li,{children:"Less commonly used"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Best For"}),": Complex contact scenarios, soft robotics"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"simbody",children:"Simbody"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Most accurate but slower"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pros"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Most physically accurate"}),"\n",(0,r.jsx)(n.li,{children:"Better for biomechanics"}),"\n",(0,r.jsx)(n.li,{children:"Precise constraint solving"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cons"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Slowest performance"}),"\n",(0,r.jsx)(n.li,{children:"More complex configuration"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Best For"}),": High-accuracy requirements, research"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"choosing-the-right-engine",children:"Choosing the Right Engine"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# In world file or launch file\r\n<physics type="ode">  # or "bullet" or "simbody"\r\n  <max_step_size>0.001</max_step_size>\r\n  <real_time_factor>1.0</real_time_factor>\r\n</physics>\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Recommendation"}),": Start with ODE, switch to Bullet if you have contact issues, use Simbody only if you need maximum accuracy."]}),"\n",(0,r.jsx)(n.h2,{id:"gravity-configuration",children:"Gravity Configuration"}),"\n",(0,r.jsx)(n.p,{children:"Gravity is a fundamental force in physics simulation. Configuring it correctly is essential for realistic behavior."}),"\n",(0,r.jsx)(n.h3,{id:"setting-gravity",children:"Setting Gravity"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'\x3c!-- In world file --\x3e\r\n<world name="my_world">\r\n  <physics type="ode">\r\n    <gravity>0 0 -9.81</gravity>  \x3c!-- Earth gravity --\x3e\r\n    \x3c!-- or --\x3e\r\n    <gravity>0 0 -1.62</gravity>  \x3c!-- Moon gravity --\x3e\r\n    \x3c!-- or --\x3e\r\n    <gravity>0 0 0</gravity>      \x3c!-- No gravity --\x3e\r\n  </physics>\r\n</world>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"gravity-in-different-environments",children:"Gravity in Different Environments"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Earth: 9.81 m/s\xb2\r\ngravity_earth = [0, 0, -9.81]\r\n\r\n# Moon: 1.62 m/s\xb2\r\ngravity_moon = [0, 0, -1.62]\r\n\r\n# Mars: 3.71 m/s\xb2\r\ngravity_mars = [0, 0, -3.71]\r\n\r\n# Space: 0 m/s\xb2\r\ngravity_space = [0, 0, 0]\n"})}),"\n",(0,r.jsx)(n.h3,{id:"per-link-gravity-control",children:"Per-Link Gravity Control"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'\x3c!-- Disable gravity for specific link --\x3e\r\n<gazebo reference="floating_link">\r\n  <turnGravityOff>true</turnGravityOff>\r\n</gazebo>\n'})}),"\n",(0,r.jsx)(n.h2,{id:"friction-and-contact",children:"Friction and Contact"}),"\n",(0,r.jsx)(n.p,{children:"Friction determines how objects interact when in contact. Proper friction modeling is crucial for realistic robot behavior."}),"\n",(0,r.jsx)(n.h3,{id:"friction-configuration",children:"Friction Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'\x3c!-- In link definition --\x3e\r\n<link name="wheel">\r\n  <collision name="collision">\r\n    <surface>\r\n      <friction>\r\n        <ode>\r\n          <mu>0.8</mu>        \x3c!-- Static friction coefficient --\x3e\r\n          <mu2>0.6</mu2>       \x3c!-- Dynamic friction coefficient --\x3e\r\n          <fdir1>0 0 0</fdir1> \x3c!-- Friction direction --\x3e\r\n          <slip1>0.0</slip1>   \x3c!-- Slip in direction 1 --\x3e\r\n          <slip2>0.0</slip2>   \x3c!-- Slip in direction 2 --\x3e\r\n        </ode>\r\n      </friction>\r\n    </surface>\r\n  </collision>\r\n</link>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"common-friction-coefficients",children:"Common Friction Coefficients"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Material"}),(0,r.jsx)(n.th,{children:"Static (\u03bc)"}),(0,r.jsx)(n.th,{children:"Dynamic (\u03bc\u2082)"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Rubber on concrete"}),(0,r.jsx)(n.td,{children:"0.9"}),(0,r.jsx)(n.td,{children:"0.7"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Metal on metal"}),(0,r.jsx)(n.td,{children:"0.5"}),(0,r.jsx)(n.td,{children:"0.3"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Wood on wood"}),(0,r.jsx)(n.td,{children:"0.4"}),(0,r.jsx)(n.td,{children:"0.2"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Ice on ice"}),(0,r.jsx)(n.td,{children:"0.1"}),(0,r.jsx)(n.td,{children:"0.05"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Teflon on Teflon"}),(0,r.jsx)(n.td,{children:"0.04"}),(0,r.jsx)(n.td,{children:"0.04"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"friction-example",children:"Friction Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'\x3c!-- High-friction wheel --\x3e\r\n<link name="high_friction_wheel">\r\n  <collision name="collision">\r\n    <surface>\r\n      <friction>\r\n        <ode>\r\n          <mu>1.0</mu>\r\n          <mu2>0.8</mu2>\r\n        </ode>\r\n      </friction>\r\n    </surface>\r\n  </collision>\r\n</link>\r\n\r\n\x3c!-- Low-friction slider --\x3e\r\n<link name="low_friction_slider">\r\n  <collision name="collision">\r\n    <surface>\r\n      <friction>\r\n        <ode>\r\n          <mu>0.1</mu>\r\n          <mu2>0.05</mu2>\r\n        </ode>\r\n      </friction>\r\n    </surface>\r\n  </collision>\r\n</link>\n'})}),"\n",(0,r.jsx)(n.h2,{id:"mass-and-inertia",children:"Mass and Inertia"}),"\n",(0,r.jsx)(n.p,{children:"Mass and inertia properties determine how objects respond to forces. Accurate values are essential for realistic simulation."}),"\n",(0,r.jsx)(n.h3,{id:"mass-definition",children:"Mass Definition"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<inertial>\r\n  <mass value="10.0"/>  \x3c!-- Kilograms --\x3e\r\n  <inertia ixx="0.4" ixy="0" ixz="0"\r\n           iyy="0.4" iyz="0" izz="0.4"/>\r\n</inertial>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"inertia-matrix",children:"Inertia Matrix"}),"\n",(0,r.jsx)(n.p,{children:"The inertia matrix describes how mass is distributed:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"I = [Ixx  Ixy  Ixz]\r\n    [Ixy  Iyy  Iyz]\r\n    [Ixz  Iyz  Izz]\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Diagonal elements"})," (Ixx, Iyy, Izz): Moments of inertia"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Off-diagonal elements"})," (Ixy, Ixz, Iyz): Products of inertia (usually 0 for symmetric objects)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"calculating-inertia",children:"Calculating Inertia"}),"\n",(0,r.jsx)(n.p,{children:"For simple shapes:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Box"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Ixx = (1/12) * m * (h\xb2 + d\xb2)\r\nIyy = (1/12) * m * (w\xb2 + d\xb2)\r\nIzz = (1/12) * m * (w\xb2 + h\xb2)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cylinder"})," (axis along z):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Ixx = Iyy = (1/12) * m * (3*r\xb2 + h\xb2)\r\nIzz = (1/2) * m * r\xb2\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Sphere"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Ixx = Iyy = Izz = (2/5) * m * r\xb2\n"})}),"\n",(0,r.jsx)(n.h3,{id:"inertia-example",children:"Inertia Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'\x3c!-- Box: 1m x 0.5m x 0.3m, mass 10kg --\x3e\r\n<inertial>\r\n  <mass value="10.0"/>\r\n  <inertia ixx="0.283" ixy="0" ixz="0"\r\n           iyy="0.458" iyz="0"\r\n           izz="0.542"/>\r\n</inertial>\r\n\r\n\x3c!-- Cylinder: radius 0.1m, height 0.5m, mass 5kg --\x3e\r\n<inertial>\r\n  <mass value="5.0"/>\r\n  <inertia ixx="0.021" ixy="0" ixz="0"\r\n           iyy="0.021" iyz="0"\r\n           izz="0.025"/>\r\n</inertial>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"center-of-mass",children:"Center of Mass"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<inertial>\r\n  <origin xyz="0 0 0.1" rpy="0 0 0"/>  \x3c!-- COM offset --\x3e\r\n  <mass value="10.0"/>\r\n  <inertia ixx="0.4" ixy="0" ixz="0"\r\n           iyy="0.4" iyz="0" izz="0.4"/>\r\n</inertial>\n'})}),"\n",(0,r.jsx)(n.h2,{id:"physics-parameters",children:"Physics Parameters"}),"\n",(0,r.jsx)(n.h3,{id:"step-size",children:"Step Size"}),"\n",(0,r.jsx)(n.p,{children:"Controls simulation accuracy vs performance:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<physics type="ode">\r\n  <max_step_size>0.001</max_step_size>  \x3c!-- Smaller = more accurate but slower --\x3e\r\n</physics>\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Guidelines"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"0.0001"}),": Very high accuracy (slow)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"0.001"}),": Good balance (default)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"0.01"}),": Lower accuracy (fast)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"real-time-factor",children:"Real-Time Factor"}),"\n",(0,r.jsx)(n.p,{children:"Controls simulation speed relative to real time:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"<real_time_factor>1.0</real_time_factor>  \x3c!-- Real-time --\x3e\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"1.0"}),": Real-time (1 second simulation = 1 second real time)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Greater than 1.0"}),": Faster than real-time"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Less than 1.0"}),": Slower than real-time"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"solver-parameters-ode",children:"Solver Parameters (ODE)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<physics type="ode">\r\n  <solver>\r\n    <type>quick</type>        \x3c!-- or "world" --\x3e\r\n    <iters>50</iters>         \x3c!-- Solver iterations --\x3e\r\n    <sor>1.3</sor>            \x3c!-- Successive Over-Relaxation --\x3e\r\n    <use_dynamic_moi_rescaling>1</use_dynamic_moi_rescaling>\r\n  </solver>\r\n  <constraints>\r\n    <cfm>0.00001</cfm>        \x3c!-- Constraint Force Mixing --\x3e\r\n    <erp>0.2</erp>            \x3c!-- Error Reduction Parameter --\x3e\r\n    <contact_max_correcting_vel>100</contact_max_correcting_vel>\r\n    <contact_surface_layer>0.001</contact_surface_layer>\r\n  </constraints>\r\n</physics>\n'})}),"\n",(0,r.jsx)(n.h2,{id:"debugging-physics",children:"Debugging Physics"}),"\n",(0,r.jsx)(n.h3,{id:"common-physics-issues",children:"Common Physics Issues"}),"\n",(0,r.jsx)(n.h4,{id:"issue-1-objects-penetrating",children:"Issue 1: Objects Penetrating"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptoms"}),": Objects pass through each other"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Increase solver iterations"}),"\n",(0,r.jsx)(n.li,{children:"Decrease step size"}),"\n",(0,r.jsx)(n.li,{children:"Check collision geometries"}),"\n",(0,r.jsx)(n.li,{children:"Increase contact surface layer"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"<constraints>\r\n  <contact_surface_layer>0.01</contact_surface_layer>  \x3c!-- Increase --\x3e\r\n</constraints>\n"})}),"\n",(0,r.jsx)(n.h4,{id:"issue-2-jittery-motion",children:"Issue 2: Jittery Motion"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptoms"}),": Objects shake or vibrate"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Increase CFM (Constraint Force Mixing)"}),"\n",(0,r.jsx)(n.li,{children:"Decrease ERP (Error Reduction Parameter)"}),"\n",(0,r.jsx)(n.li,{children:"Check mass/inertia values"}),"\n",(0,r.jsx)(n.li,{children:"Use proper damping"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"<constraints>\r\n  <cfm>0.0001</cfm>  \x3c!-- Increase for stability --\x3e\r\n  <erp>0.1</erp>     \x3c!-- Decrease for stability --\x3e\r\n</constraints>\n"})}),"\n",(0,r.jsx)(n.h4,{id:"issue-3-objects-flying-away",children:"Issue 3: Objects Flying Away"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptoms"}),": Objects accelerate unexpectedly"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Check mass values (too small?)"}),"\n",(0,r.jsx)(n.li,{children:"Verify inertia calculations"}),"\n",(0,r.jsx)(n.li,{children:"Check for conflicting forces"}),"\n",(0,r.jsx)(n.li,{children:"Review joint limits"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"issue-4-slow-simulation",children:"Issue 4: Slow Simulation"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Symptoms"}),": Simulation runs slower than real-time"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Increase step size (carefully)"}),"\n",(0,r.jsx)(n.li,{children:"Reduce solver iterations"}),"\n",(0,r.jsx)(n.li,{children:"Simplify collision geometries"}),"\n",(0,r.jsx)(n.li,{children:"Use simpler physics engine"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"physics-debug-visualization",children:"Physics Debug Visualization"}),"\n",(0,r.jsx)(n.p,{children:"Enable debug visualization to see forces and contacts:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# In Python/Gazebo API\r\nimport gazebo_msgs.srv import GetPhysicsProperties\r\n\r\n# Or in world file\r\n<scene>\r\n  <ambient>0.4 0.4 0.4 1</ambient>\r\n  <shadows>true</shadows>\r\n  <grid>true</grid>\r\n</scene>\n"})}),"\n",(0,r.jsx)(n.h3,{id:"monitoring-physics",children:"Monitoring Physics"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Check real-time factor\r\ngz stats\r\n\r\n# Monitor physics performance\r\ngz topic -e /gazebo/default/physics/contacts\n"})}),"\n",(0,r.jsx)(n.h2,{id:"performance-tips",children:"Performance Tips"}),"\n",(0,r.jsx)(n.h3,{id:"1-optimize-collision-geometries",children:"1. Optimize Collision Geometries"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'\x3c!-- Good: Simple box --\x3e\r\n<collision>\r\n  <geometry>\r\n    <box size="1 1 1"/>\r\n  </geometry>\r\n</collision>\r\n\r\n\x3c!-- Bad: Complex mesh --\x3e\r\n<collision>\r\n  <geometry>\r\n    <mesh filename="complex_model.dae"/>\r\n  </geometry>\r\n</collision>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"2-use-appropriate-step-size",children:"2. Use Appropriate Step Size"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"\x3c!-- Balance accuracy and performance --\x3e\r\n<max_step_size>0.001</max_step_size>  \x3c!-- Good default --\x3e\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-limit-solver-iterations",children:"3. Limit Solver Iterations"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"<solver>\r\n  <iters>50</iters>  \x3c!-- Increase for accuracy, decrease for speed --\x3e\r\n</solver>\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-simplify-models",children:"4. Simplify Models"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use fewer links when possible"}),"\n",(0,r.jsx)(n.li,{children:"Combine simple shapes"}),"\n",(0,r.jsx)(n.li,{children:"Remove unnecessary details"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"5-use-static-objects",children:"5. Use Static Objects"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<model name="static_wall">\r\n  <static>true</static>  \x3c!-- No physics computation --\x3e\r\n  \x3c!-- ... --\x3e\r\n</model>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"6-optimize-contact-detection",children:"6. Optimize Contact Detection"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<collision name="collision">\r\n  <geometry>...</geometry>\r\n  <max_contacts>10</max_contacts>  \x3c!-- Limit contacts --\x3e\r\n</collision>\n'})}),"\n",(0,r.jsx)(n.h2,{id:"complete-physics-configuration-example",children:"Complete Physics Configuration Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0"?>\r\n<sdf version="1.6">\r\n  <world name="optimized_world">\r\n    <physics type="ode" name="default_physics" default="0" type="ode">\r\n      <max_step_size>0.001</max_step_size>\r\n      <real_time_factor>1.0</real_time_factor>\r\n      <real_time_update_rate>1000</real_time_update_rate>\r\n      \r\n      <gravity>0 0 -9.81</gravity>\r\n      \r\n      <solver>\r\n        <type>quick</type>\r\n        <iters>50</iters>\r\n        <sor>1.3</sor>\r\n        <use_dynamic_moi_rescaling>1</use_dynamic_moi_rescaling>\r\n      </solver>\r\n      \r\n      <constraints>\r\n        <cfm>0.00001</cfm>\r\n        <erp>0.2</erp>\r\n        <contact_max_correcting_vel>100</contact_max_correcting_vel>\r\n        <contact_surface_layer>0.001</contact_surface_layer>\r\n      </constraints>\r\n    </physics>\r\n    \r\n    \x3c!-- Models with proper physics --\x3e\r\n    <model name="robot">\r\n      <link name="base">\r\n        <collision name="collision">\r\n          <geometry>\r\n            <box>\r\n              <size>0.4 0.3 0.2</size>\r\n            </box>\r\n          </geometry>\r\n          <surface>\r\n            <friction>\r\n              <ode>\r\n                <mu>0.8</mu>\r\n                <mu2>0.6</mu2>\r\n              </ode>\r\n            </friction>\r\n          </surface>\r\n        </collision>\r\n        <inertial>\r\n          <mass>5.0</mass>\r\n          <inertia>\r\n            <ixx>0.1</ixx>\r\n            <iyy>0.1</iyy>\r\n            <izz>0.1</izz>\r\n          </inertia>\r\n        </inertial>\r\n      </link>\r\n    </model>\r\n  </world>\r\n</sdf>\n'})}),"\n",(0,r.jsx)(n.h2,{id:"common-pitfalls",children:"Common Pitfalls"}),"\n",(0,r.jsx)(n.h3,{id:"pitfall-1-unrealistic-mass-values",children:"Pitfall 1: Unrealistic Mass Values"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem"}),": Robot too light or too heavy"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": Research actual component weights and scale appropriately"]}),"\n",(0,r.jsx)(n.h3,{id:"pitfall-2-incorrect-inertia",children:"Pitfall 2: Incorrect Inertia"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem"}),": Robot rotates unrealistically"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": Calculate inertia properly or use CAD software"]}),"\n",(0,r.jsx)(n.h3,{id:"pitfall-3-too-small-step-size",children:"Pitfall 3: Too Small Step Size"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem"}),": Simulation too slow"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": Balance accuracy and performance (0.001 is usually good)"]}),"\n",(0,r.jsx)(n.h3,{id:"pitfall-4-missing-friction",children:"Pitfall 4: Missing Friction"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Problem"}),": Robot slides unrealistically"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Solution"}),": Set appropriate friction coefficients"]}),"\n",(0,r.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsx)(n.p,{children:"Continue learning:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/physical-ai-textbook/docs/module-02-simulation/sensor-simulation",children:"Chapter 4: Sensor Simulation"})," - Add sensors to your robot"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/physical-ai-textbook/docs/module-02-simulation/unity-integration",children:"Chapter 5: Unity Integration"})," - High-fidelity rendering"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>c});var s=i(6540);const r={},l=s.createContext(r);function t(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);
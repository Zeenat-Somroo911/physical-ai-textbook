"use strict";(globalThis.webpackChunkphysical_ai_textbook=globalThis.webpackChunkphysical_ai_textbook||[]).push([[7176],{8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>t});var r=s(6540);const i={},l=r.createContext(i);function o(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(l.Provider,{value:n},e.children)}},9798:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"module-01-ros2/chapter-06-best-practices","title":"Chapter 6: ROS2 Best Practices","description":"Introduction","source":"@site/docs/module-01-ros2/chapter-06-best-practices.md","sourceDirName":"module-01-ros2","slug":"/module-01-ros2/chapter-06-best-practices","permalink":"/physical-ai-textbook/docs/module-01-ros2/chapter-06-best-practices","draft":false,"unlisted":false,"editUrl":"https://github.com/Zeenat-Somroo911/physical-ai-textbook/edit/main/docs/module-01-ros2/chapter-06-best-practices.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7}}');var i=s(4848),l=s(8453);const o={sidebar_position:7},t="Chapter 6: ROS2 Best Practices",a={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Code Organization",id:"code-organization",level:2},{value:"Package Structure",id:"package-structure",level:3},{value:"Naming Conventions",id:"naming-conventions",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Logging",id:"logging",level:2},{value:"Resource Management",id:"resource-management",level:2},{value:"Timers",id:"timers",level:3},{value:"Subscriptions",id:"subscriptions",level:3},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"Avoid Blocking in Callbacks",id:"avoid-blocking-in-callbacks",level:3},{value:"Efficient Message Handling",id:"efficient-message-handling",level:3},{value:"Testing",id:"testing",level:2},{value:"Unit Tests",id:"unit-tests",level:3},{value:"Documentation",id:"documentation",level:2},{value:"Code Comments",id:"code-comments",level:3},{value:"README Files",id:"readme-files",level:3},{value:"Security",id:"security",level:2},{value:"Version Control",id:"version-control",level:2},{value:"Common Pitfalls",id:"common-pitfalls",level:2},{value:"Exercises",id:"exercises",level:2},{value:"Module Summary",id:"module-summary",level:2},{value:"Next Module",id:"next-module",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"chapter-6-ros2-best-practices",children:"Chapter 6: ROS2 Best Practices"})}),"\n",(0,i.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsx)(n.p,{children:"This chapter covers best practices for developing robust, maintainable, and efficient ROS2 applications. Learn from common patterns and avoid common pitfalls."}),"\n",(0,i.jsx)(n.h2,{id:"code-organization",children:"Code Organization"}),"\n",(0,i.jsx)(n.h3,{id:"package-structure",children:"Package Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"my_robot_package/\r\n\u251c\u2500\u2500 CMakeLists.txt\r\n\u251c\u2500\u2500 package.xml\r\n\u251c\u2500\u2500 setup.py\r\n\u251c\u2500\u2500 setup.cfg\r\n\u251c\u2500\u2500 my_robot_package/\r\n\u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u251c\u2500\u2500 nodes/\r\n\u2502   \u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u2502   \u2514\u2500\u2500 my_node.py\r\n\u2502   \u251c\u2500\u2500 modules/\r\n\u2502   \u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u2502   \u2514\u2500\u2500 utilities.py\r\n\u2502   \u2514\u2500\u2500 msg/\r\n\u2502       \u2514\u2500\u2500 CustomMessage.msg\r\n\u251c\u2500\u2500 launch/\r\n\u2502   \u2514\u2500\u2500 my_launch.py\r\n\u251c\u2500\u2500 config/\r\n\u2502   \u2514\u2500\u2500 params.yaml\r\n\u2514\u2500\u2500 test/\r\n    \u2514\u2500\u2500 test_my_node.py\n"})}),"\n",(0,i.jsx)(n.h3,{id:"naming-conventions",children:"Naming Conventions"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Packages"}),": ",(0,i.jsx)(n.code,{children:"snake_case"})," (e.g., ",(0,i.jsx)(n.code,{children:"my_robot_package"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Nodes"}),": Descriptive names (e.g., ",(0,i.jsx)(n.code,{children:"sensor_driver_node"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Topics"}),": ",(0,i.jsx)(n.code,{children:"snake_case"})," with namespace (e.g., ",(0,i.jsx)(n.code,{children:"/robot/sensor_data"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Services"}),": ",(0,i.jsx)(n.code,{children:"snake_case"})," (e.g., ",(0,i.jsx)(n.code,{children:"/robot/get_status"}),")"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\n\r\nclass RobustNode(Node):\r\n    def __init__(self):\r\n        super().__init__('robust_node')\r\n        try:\r\n            self.publisher_ = self.create_publisher(String, 'topic', 10)\r\n        except Exception as e:\r\n            self.get_logger().error(f'Failed to create publisher: {e}')\r\n            raise\n"})}),"\n",(0,i.jsx)(n.h2,{id:"logging",children:"Logging"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Use appropriate log levels\r\nself.get_logger().debug('Detailed debugging information')\r\nself.get_logger().info('General information')\r\nself.get_logger().warn('Warning message')\r\nself.get_logger().error('Error occurred')\r\nself.get_logger().fatal('Fatal error')\n"})}),"\n",(0,i.jsx)(n.h2,{id:"resource-management",children:"Resource Management"}),"\n",(0,i.jsx)(n.h3,{id:"timers",children:"Timers"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Clean up timers properly\r\ndef destroy_node(self):\r\n    self.timer.destroy()\r\n    super().destroy_node()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"subscriptions",children:"Subscriptions"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Use appropriate queue sizes\r\nself.subscription = self.create_subscription(\r\n    String,\r\n    'topic',\r\n    self.callback,\r\n    10  # Queue size - adjust based on message rate\r\n)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,i.jsx)(n.h3,{id:"avoid-blocking-in-callbacks",children:"Avoid Blocking in Callbacks"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Bad: Blocking operation in callback\r\ndef callback(self, msg):\r\n    time.sleep(1.0)  # Blocks the executor\r\n    self.process(msg)\r\n\r\n# Good: Use async or separate thread\r\ndef callback(self, msg):\r\n    # Queue for processing\r\n    self.message_queue.put(msg)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"efficient-message-handling",children:"Efficient Message Handling"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Reuse message objects when possible\r\nself.msg = String()\r\n\r\ndef timer_callback(self):\r\n    self.msg.data = f'Count: {self.i}'\r\n    self.publisher_.publish(self.msg)\r\n    self.i += 1\n"})}),"\n",(0,i.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,i.jsx)(n.h3,{id:"unit-tests",children:"Unit Tests"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import unittest\r\nimport rclpy\r\nfrom my_package.nodes.my_node import MyNode\r\n\r\nclass TestMyNode(unittest.TestCase):\r\n    def setUp(self):\r\n        rclpy.init()\r\n        self.node = MyNode()\r\n\r\n    def tearDown(self):\r\n        self.node.destroy_node()\r\n        rclpy.shutdown()\r\n\r\n    def test_initialization(self):\r\n        self.assertIsNotNone(self.node)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"documentation",children:"Documentation"}),"\n",(0,i.jsx)(n.h3,{id:"code-comments",children:"Code Comments"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'class MyNode(Node):\r\n    """\r\n    A node that processes sensor data.\r\n    \r\n    This node subscribes to sensor topics and processes\r\n    the incoming data to extract meaningful information.\r\n    """\r\n    def __init__(self):\r\n        super().__init__(\'my_node\')\n'})}),"\n",(0,i.jsx)(n.h3,{id:"readme-files",children:"README Files"}),"\n",(0,i.jsx)(n.p,{children:"Always include:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Package description"}),"\n",(0,i.jsx)(n.li,{children:"Installation instructions"}),"\n",(0,i.jsx)(n.li,{children:"Usage examples"}),"\n",(0,i.jsx)(n.li,{children:"Parameter documentation"}),"\n",(0,i.jsx)(n.li,{children:"Launch file descriptions"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"security",children:"Security"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use ROS2 security features in production"}),"\n",(0,i.jsx)(n.li,{children:"Validate all inputs"}),"\n",(0,i.jsx)(n.li,{children:"Use namespaces to isolate components"}),"\n",(0,i.jsx)(n.li,{children:"Set appropriate permissions"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"version-control",children:"Version Control"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.code,{children:".gitignore"})," for build artifacts"]}),"\n",(0,i.jsxs)(n.li,{children:["Commit ",(0,i.jsx)(n.code,{children:"package.xml"})," and ",(0,i.jsx)(n.code,{children:"CMakeLists.txt"})]}),"\n",(0,i.jsx)(n.li,{children:"Document dependencies"}),"\n",(0,i.jsx)(n.li,{children:"Tag releases"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"common-pitfalls",children:"Common Pitfalls"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Forgetting to spin"}),": Always call ",(0,i.jsx)(n.code,{children:"rclpy.spin()"})," or use an executor"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Wrong message types"}),": Ensure publisher and subscriber use the same type"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Queue overflow"}),": Set appropriate queue sizes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Namespace issues"}),": Be aware of node namespaces"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Parameter not declared"}),": Always declare parameters before use"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"exercises",children:"Exercises"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Refactor a simple node following best practices"}),"\n",(0,i.jsx)(n.li,{children:"Add comprehensive error handling"}),"\n",(0,i.jsx)(n.li,{children:"Write unit tests for your nodes"}),"\n",(0,i.jsx)(n.li,{children:"Create proper documentation"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"module-summary",children:"Module Summary"}),"\n",(0,i.jsx)(n.p,{children:"Congratulations! You've completed Module 1. You now understand:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"ROS2 fundamentals"}),"\n",(0,i.jsx)(n.li,{children:"Nodes, topics, services, and actions"}),"\n",(0,i.jsx)(n.li,{children:"Parameters and launch files"}),"\n",(0,i.jsx)(n.li,{children:"Best practices for ROS2 development"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"next-module",children:"Next Module"}),"\n",(0,i.jsx)(n.p,{children:"In Module 2, we'll explore simulation and Gazebo, learning how to create and simulate robots in virtual environments."})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);
"use strict";(globalThis.webpackChunkphysical_ai_textbook=globalThis.webpackChunkphysical_ai_textbook||[]).push([[7111],{5895:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>m,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"module-04-vla/chapter-05-end-to-end-systems","title":"Chapter 5: End-to-End Systems","description":"Introduction","source":"@site/docs/module-04-vla/chapter-05-end-to-end-systems.md","sourceDirName":"module-04-vla","slug":"/module-04-vla/chapter-05-end-to-end-systems","permalink":"/physical-ai-textbook/docs/module-04-vla/chapter-05-end-to-end-systems","draft":false,"unlisted":false,"editUrl":"https://github.com/Zeenat-Somroo911/physical-ai-textbook/edit/main/docs/module-04-vla/chapter-05-end-to-end-systems.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6}}');var t=i(4848),s=i(8453);const o={sidebar_position:6},l="Chapter 5: End-to-End Systems",a={},c=[{value:"Introduction",id:"introduction",level:2},{value:"System Architecture",id:"system-architecture",level:2},{value:"Complete VLA Pipeline",id:"complete-vla-pipeline",level:3},{value:"RT-1/RT-2 Architecture",id:"rt-1rt-2-architecture",level:2},{value:"Robotics Transformer",id:"robotics-transformer",level:3},{value:"Real-Time Inference",id:"real-time-inference",level:2},{value:"Optimization",id:"optimization",level:3},{value:"Efficient Deployment",id:"efficient-deployment",level:3},{value:"Integration with ROS2",id:"integration-with-ros2",level:2},{value:"ROS2 Node",id:"ros2-node",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Robustness",id:"robustness",level:3},{value:"Monitoring and Logging",id:"monitoring-and-logging",level:2},{value:"System Monitoring",id:"system-monitoring",level:3},{value:"Testing and Validation",id:"testing-and-validation",level:2},{value:"Unit Tests",id:"unit-tests",level:3},{value:"Integration Tests",id:"integration-tests",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Exercises",id:"exercises",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"chapter-5-end-to-end-systems",children:"Chapter 5: End-to-End Systems"})}),"\n",(0,t.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsx)(n.p,{children:"This chapter covers building complete end-to-end VLA systems that integrate vision, language, and action into a unified pipeline for real-world deployment."}),"\n",(0,t.jsx)(n.h2,{id:"system-architecture",children:"System Architecture"}),"\n",(0,t.jsx)(n.h3,{id:"complete-vla-pipeline",children:"Complete VLA Pipeline"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"class EndToEndVLA(nn.Module):\r\n    def __init__(self):\r\n        super().__init__()\r\n        self.vision_encoder = VisionEncoder()\r\n        self.language_encoder = LanguageEncoder()\r\n        self.multimodal_fusion = MultimodalFusion()\r\n        self.action_decoder = ActionDecoder()\r\n    \r\n    def forward(self, image, instruction):\r\n        # Encode modalities\r\n        v_features = self.vision_encoder(image)\r\n        l_features = self.language_encoder(instruction)\r\n        \r\n        # Fuse\r\n        fused = self.multimodal_fusion(v_features, l_features)\r\n        \r\n        # Decode action\r\n        action = self.action_decoder(fused)\r\n        return action\n"})}),"\n",(0,t.jsx)(n.h2,{id:"rt-1rt-2-architecture",children:"RT-1/RT-2 Architecture"}),"\n",(0,t.jsx)(n.h3,{id:"robotics-transformer",children:"Robotics Transformer"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"class RT1(nn.Module):\r\n    def __init__(self):\r\n        super().__init__()\r\n        self.tokenizer = ActionTokenizer()\r\n        self.transformer = TransformerEncoder()\r\n        self.action_head = ActionHead()\r\n    \r\n    def forward(self, images, instructions):\r\n        # Tokenize actions\r\n        action_tokens = self.tokenizer(actions)\r\n        \r\n        # Process with transformer\r\n        output = self.transformer(\r\n            vision_tokens=images,\r\n            language_tokens=instructions,\r\n            action_tokens=action_tokens\r\n        )\r\n        \r\n        # Predict next action\r\n        next_action = self.action_head(output)\r\n        return next_action\n"})}),"\n",(0,t.jsx)(n.h2,{id:"real-time-inference",children:"Real-Time Inference"}),"\n",(0,t.jsx)(n.h3,{id:"optimization",children:"Optimization"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Model quantization\r\nimport torch.quantization\r\n\r\nmodel_quantized = torch.quantization.quantize_dynamic(\r\n    model, {nn.Linear}, dtype=torch.qint8\r\n)\r\n\r\n# TensorRT optimization\r\n# (requires NVIDIA TensorRT)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"efficient-deployment",children:"Efficient Deployment"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# ONNX export\r\ntorch.onnx.export(\r\n    model,\r\n    (image, instruction),\r\n    \"vla_model.onnx\",\r\n    input_names=['image', 'instruction'],\r\n    output_names=['action']\r\n)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"integration-with-ros2",children:"Integration with ROS2"}),"\n",(0,t.jsx)(n.h3,{id:"ros2-node",children:"ROS2 Node"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom sensor_msgs.msg import Image\r\nfrom std_msgs.msg import String\r\nfrom geometry_msgs.msg import Twist\r\n\r\nclass VLARobotNode(Node):\r\n    def __init__(self):\r\n        super().__init__('vla_robot_node')\r\n        self.model = load_vla_model()\r\n        \r\n        self.image_sub = self.create_subscription(\r\n            Image, '/camera/image_raw', self.image_callback, 10\r\n        )\r\n        self.instruction_sub = self.create_subscription(\r\n            String, '/instruction', self.instruction_callback, 10\r\n        )\r\n        self.cmd_pub = self.create_publisher(\r\n            Twist, '/cmd_vel', 10\r\n        )\r\n    \r\n    def image_callback(self, msg):\r\n        image = self.msg_to_image(msg)\r\n        if self.current_instruction:\r\n            action = self.model(image, self.current_instruction)\r\n            self.publish_action(action)\r\n    \r\n    def instruction_callback(self, msg):\r\n        self.current_instruction = msg.data\n"})}),"\n",(0,t.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,t.jsx)(n.h3,{id:"robustness",children:"Robustness"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"class RobustVLA(nn.Module):\r\n    def __init__(self):\r\n        super().__init__()\r\n        self.vla_model = EndToEndVLA()\r\n        self.fallback_policy = FallbackPolicy()\r\n    \r\n    def forward(self, image, instruction):\r\n        try:\r\n            action = self.vla_model(image, instruction)\r\n            if self.is_safe(action):\r\n                return action\r\n            else:\r\n                return self.fallback_policy(image)\r\n        except Exception as e:\r\n            self.log_error(e)\r\n            return self.fallback_policy(image)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"monitoring-and-logging",children:"Monitoring and Logging"}),"\n",(0,t.jsx)(n.h3,{id:"system-monitoring",children:"System Monitoring"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"class MonitoredVLA:\r\n    def __init__(self, model):\r\n        self.model = model\r\n        self.metrics = {}\r\n    \r\n    def predict(self, image, instruction):\r\n        start_time = time.time()\r\n        action = self.model(image, instruction)\r\n        inference_time = time.time() - start_time\r\n        \r\n        self.metrics['inference_time'] = inference_time\r\n        self.metrics['action_norm'] = torch.norm(action).item()\r\n        \r\n        return action\n"})}),"\n",(0,t.jsx)(n.h2,{id:"testing-and-validation",children:"Testing and Validation"}),"\n",(0,t.jsx)(n.h3,{id:"unit-tests",children:"Unit Tests"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'def test_vla_model():\r\n    model = EndToEndVLA()\r\n    image = torch.randn(1, 3, 224, 224)\r\n    instruction = "pick up the cup"\r\n    \r\n    action = model(image, instruction)\r\n    assert action.shape == (1, action_dim)\r\n    assert torch.all(action >= -1) and torch.all(action <= 1)\n'})}),"\n",(0,t.jsx)(n.h3,{id:"integration-tests",children:"Integration Tests"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"def test_ros2_integration():\r\n    node = VLARobotNode()\r\n    # Test ROS2 communication\r\n    # Test action publishing\r\n    # Test error handling\n"})}),"\n",(0,t.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Modular design for easy debugging"}),"\n",(0,t.jsx)(n.li,{children:"Comprehensive error handling"}),"\n",(0,t.jsx)(n.li,{children:"Performance optimization"}),"\n",(0,t.jsx)(n.li,{children:"Extensive testing"}),"\n",(0,t.jsx)(n.li,{children:"Clear documentation"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"exercises",children:"Exercises"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Build end-to-end VLA system"}),"\n",(0,t.jsx)(n.li,{children:"Integrate with ROS2"}),"\n",(0,t.jsx)(n.li,{children:"Add monitoring and logging"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsx)(n.p,{children:"Chapter 6 covers real-world applications of VLA systems."})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var r=i(6540);const t={},s=r.createContext(t);function o(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);
"use strict";(globalThis.webpackChunkphysical_ai_textbook=globalThis.webpackChunkphysical_ai_textbook||[]).push([[6121],{3753:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>t,contentTitle:()=>l,default:()=>c,frontMatter:()=>o,metadata:()=>a,toc:()=>m});const a=JSON.parse('{"id":"module-02-simulation/sensor-simulation","title":"Chapter 4: Sensor Simulation","description":"Introduction","source":"@site/docs/module-02-simulation/04-sensor-simulation.md","sourceDirName":"module-02-simulation","slug":"/module-02-simulation/sensor-simulation","permalink":"/physical-ai-textbook/docs/module-02-simulation/sensor-simulation","draft":false,"unlisted":false,"editUrl":"https://github.com/Zeenat-Somroo911/physical-ai-textbook/edit/main/docs/module-02-simulation/04-sensor-simulation.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 3: Physics Simulation","permalink":"/physical-ai-textbook/docs/module-02-simulation/physics-simulation"},"next":{"title":"Chapter 5: Unity Integration","permalink":"/physical-ai-textbook/docs/module-02-simulation/unity-integration"}}');var i=r(4848),s=r(8453);const o={sidebar_position:4},l="Chapter 4: Sensor Simulation",t={},m=[{value:"Introduction",id:"introduction",level:2},{value:"Camera Sensors",id:"camera-sensors",level:2},{value:"Basic Camera Configuration",id:"basic-camera-configuration",level:3},{value:"Camera Parameters Explained",id:"camera-parameters-explained",level:3},{value:"Stereo Camera Setup",id:"stereo-camera-setup",level:3},{value:"Depth Camera (RGB-D)",id:"depth-camera-rgb-d",level:3},{value:"LiDAR Sensors",id:"lidar-sensors",level:2},{value:"2D LiDAR (Laser Scanner)",id:"2d-lidar-laser-scanner",level:3},{value:"3D LiDAR (Velodyne-style)",id:"3d-lidar-velodyne-style",level:3},{value:"LiDAR Parameters",id:"lidar-parameters",level:3},{value:"IMU Sensors",id:"imu-sensors",level:2},{value:"IMU Configuration",id:"imu-configuration",level:3},{value:"Noise Models",id:"noise-models",level:2},{value:"Noise Types",id:"noise-types",level:3},{value:"Gaussian Noise",id:"gaussian-noise",level:3},{value:"Noise Parameters",id:"noise-parameters",level:3},{value:"Adding Noise to Camera",id:"adding-noise-to-camera",level:3},{value:"Adding Noise to LiDAR",id:"adding-noise-to-lidar",level:3},{value:"Sensor Data in ROS 2",id:"sensor-data-in-ros-2",level:2},{value:"Camera Topics",id:"camera-topics",level:3},{value:"LiDAR Topics",id:"lidar-topics",level:3},{value:"IMU Topics",id:"imu-topics",level:3},{value:"Subscribing to Sensor Data",id:"subscribing-to-sensor-data",level:3},{value:"Visualization in RViz2",id:"visualization-in-rviz2",level:2},{value:"Launching RViz2",id:"launching-rviz2",level:3},{value:"Display Types",id:"display-types",level:3},{value:"RViz2 Configuration",id:"rviz2-configuration",level:3},{value:"Complete Sensor Suite Example",id:"complete-sensor-suite-example",level:2},{value:"Common Pitfalls",id:"common-pitfalls",level:2},{value:"Pitfall 1: Sensor Not Publishing",id:"pitfall-1-sensor-not-publishing",level:3},{value:"Pitfall 2: Wrong Coordinate Frame",id:"pitfall-2-wrong-coordinate-frame",level:3},{value:"Pitfall 3: Too High Update Rate",id:"pitfall-3-too-high-update-rate",level:3},{value:"Next Steps",id:"next-steps",level:2}];function d(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"chapter-4-sensor-simulation",children:"Chapter 4: Sensor Simulation"})}),"\n",(0,i.jsx)(e.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsx)(e.p,{children:"Sensors are the eyes and ears of robots. Simulating sensors accurately in Gazebo is crucial for developing perception algorithms and testing robot behavior before deployment. This chapter covers camera, LiDAR, IMU sensors, noise models, ROS 2 integration, and visualization."}),"\n",(0,i.jsx)(e.h2,{id:"camera-sensors",children:"Camera Sensors"}),"\n",(0,i.jsx)(e.p,{children:"Cameras are one of the most common sensors in robotics, providing visual information for navigation, object detection, and manipulation."}),"\n",(0,i.jsx)(e.h3,{id:"basic-camera-configuration",children:"Basic Camera Configuration"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<gazebo reference="camera_link">\r\n  <sensor type="camera" name="camera1">\r\n    <update_rate>30</update_rate>\r\n    <camera name="head">\r\n      <horizontal_fov>1.047</horizontal_fov>  \x3c!-- 60 degrees --\x3e\r\n      <image>\r\n        <width>640</width>\r\n        <height>480</height>\r\n        <format>R8G8B8</format>\r\n      </image>\r\n      <clip>\r\n        <near>0.02</near>\r\n        <far>300</far>\r\n      </clip>\r\n    </camera>\r\n    <plugin name="camera_controller" filename="libgazebo_ros_camera.so">\r\n      <ros>\r\n        <namespace>/camera</namespace>\r\n      </ros>\r\n      <camera_name>camera</camera_name>\r\n      <frame_name>camera_link</frame_name>\r\n      <hack_baseline>0.07</hack_baseline>\r\n    </plugin>\r\n  </sensor>\r\n</gazebo>\n'})}),"\n",(0,i.jsx)(e.h3,{id:"camera-parameters-explained",children:"Camera Parameters Explained"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"update_rate"}),": Frames per second (Hz)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"horizontal_fov"}),": Horizontal field of view in radians"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"width/height"}),": Image resolution in pixels"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"format"}),": Color format (R8G8B8, L8, etc.)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"near/far"}),": Clipping planes (objects closer/farther are not rendered)"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"stereo-camera-setup",children:"Stereo Camera Setup"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!-- Left Camera --\x3e\r\n<gazebo reference="left_camera_link">\r\n  <sensor type="camera" name="left_camera">\r\n    <update_rate>30</update_rate>\r\n    <camera name="left">\r\n      <horizontal_fov>1.047</horizontal_fov>\r\n      <image>\r\n        <width>640</width>\r\n        <height>480</height>\r\n        <format>R8G8B8</format>\r\n      </image>\r\n    </camera>\r\n    <plugin name="left_camera_controller" filename="libgazebo_ros_camera.so">\r\n      <ros>\r\n        <namespace>/left_camera</namespace>\r\n      </ros>\r\n      <camera_name>left</camera_name>\r\n      <frame_name>left_camera_link</frame_name>\r\n    </plugin>\r\n  </sensor>\r\n</gazebo>\r\n\r\n\x3c!-- Right Camera --\x3e\r\n<gazebo reference="right_camera_link">\r\n  <sensor type="camera" name="right_camera">\r\n    <update_rate>30</update_rate>\r\n    <camera name="right">\r\n      <horizontal_fov>1.047</horizontal_fov>\r\n      <image>\r\n        <width>640</width>\r\n        <height>480</height>\r\n        <format>R8G8B8</format>\r\n      </image>\r\n    </camera>\r\n    <plugin name="right_camera_controller" filename="libgazebo_ros_camera.so">\r\n      <ros>\r\n        <namespace>/right_camera</namespace>\r\n      </ros>\r\n      <camera_name>right</camera_name>\r\n      <frame_name>right_camera_link</frame_name>\r\n      <hack_baseline>0.12</hack_baseline>  \x3c!-- Stereo baseline --\x3e\r\n    </plugin>\r\n  </sensor>\r\n</gazebo>\n'})}),"\n",(0,i.jsx)(e.h3,{id:"depth-camera-rgb-d",children:"Depth Camera (RGB-D)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<gazebo reference="depth_camera_link">\r\n  <sensor type="depth" name="depth_camera">\r\n    <update_rate>30</update_rate>\r\n    <camera name="depth">\r\n      <horizontal_fov>1.047</horizontal_fov>\r\n      <image>\r\n        <width>640</width>\r\n        <height>480</height>\r\n        <format>R8G8B8</format>\r\n      </image>\r\n      <clip>\r\n        <near>0.05</near>\r\n        <far>10.0</far>\r\n      </clip>\r\n    </camera>\r\n    <plugin name="depth_camera_controller" filename="libgazebo_ros_openni_kinect.so">\r\n      <baseline>0.2</baseline>\r\n      <alwaysOn>true</alwaysOn>\r\n      <updateRate>1.0</updateRate>\r\n      <cameraName>depth_camera</cameraName>\r\n      <imageTopicName>rgb/image_raw</imageTopicName>\r\n      <cameraInfoTopicName>rgb/camera_info</cameraInfoTopicName>\r\n      <depthImageTopicName>depth/image_raw</depthImageTopicName>\r\n      <depthImageCameraInfoTopicName>depth/camera_info</depthImageCameraInfoTopicName>\r\n      <pointCloudTopicName>points</pointCloudTopicName>\r\n      <frameName>depth_camera_link</frameName>\r\n      <pointCloudCutoff>0.5</pointCloudCutoff>\r\n      <pointCloudCutoffMax>3.0</pointCloudCutoffMax>\r\n      <distortionK1>0</distortionK1>\r\n      <distortionK2>0</distortionK2>\r\n      <distortionK3>0</distortionK3>\r\n      <distortionT1>0</distortionT1>\r\n      <distortionT2>0</distortionT2>\r\n      <CxPrime>0</CxPrime>\r\n      <Cx>0</Cx>\r\n      <Cy>0</Cy>\r\n      <focalLength>0</focalLength>\r\n      <hackBaseline>0</hackBaseline>\r\n    </plugin>\r\n  </sensor>\r\n</gazebo>\n'})}),"\n",(0,i.jsx)(e.h2,{id:"lidar-sensors",children:"LiDAR Sensors"}),"\n",(0,i.jsx)(e.p,{children:"LiDAR (Light Detection and Ranging) sensors provide 3D point clouds by measuring distances using laser light."}),"\n",(0,i.jsx)(e.h3,{id:"2d-lidar-laser-scanner",children:"2D LiDAR (Laser Scanner)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<gazebo reference="lidar_link">\r\n  <sensor type="ray" name="head_lidar">\r\n    <pose>0 0 0 0 0 0</pose>\r\n    <visualize>false</visualize>\r\n    <update_rate>40</update_rate>\r\n    <ray>\r\n      <scan>\r\n        <horizontal>\r\n          <samples>720</samples>        \x3c!-- Number of rays --\x3e\r\n          <resolution>1</resolution>\r\n          <min_angle>-3.14159</min_angle>  \x3c!-- -180 degrees --\x3e\r\n          <max_angle>3.14159</max_angle>    \x3c!-- +180 degrees --\x3e\r\n        </horizontal>\r\n      </scan>\r\n      <range>\r\n        <min>0.10</min>    \x3c!-- Minimum range (m) --\x3e\r\n        <max>30.0</max>    \x3c!-- Maximum range (m) --\x3e\r\n        <resolution>0.01</resolution>\r\n      </range>\r\n    </ray>\r\n    <plugin name="gazebo_ros_lidar_controller" filename="libgazebo_ros_ray_sensor.so">\r\n      <ros>\r\n        <namespace>/lidar</namespace>\r\n      </ros>\r\n      <output_type>sensor_msgs/LaserScan</output_type>\r\n      <frame_name>lidar_link</frame_name>\r\n    </plugin>\r\n  </sensor>\r\n</gazebo>\n'})}),"\n",(0,i.jsx)(e.h3,{id:"3d-lidar-velodyne-style",children:"3D LiDAR (Velodyne-style)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<gazebo reference="velodyne_link">\r\n  <sensor type="ray" name="velodyne">\r\n    <pose>0 0 0 0 0 0</pose>\r\n    <visualize>false</visualize>\r\n    <update_rate>10</update_rate>\r\n    <ray>\r\n      <scan>\r\n        <horizontal>\r\n          <samples>2200</samples>\r\n          <resolution>1</resolution>\r\n          <min_angle>-3.14159</min_angle>\r\n          <max_angle>3.14159</max_angle>\r\n        </horizontal>\r\n        <vertical>\r\n          <samples>16</samples>\r\n          <resolution>1</resolution>\r\n          <min_angle>-0.261799</min_angle>  \x3c!-- -15 degrees --\x3e\r\n          <max_angle>0.261799</max_angle>    \x3c!-- +15 degrees --\x3e\r\n        </vertical>\r\n      </scan>\r\n      <range>\r\n        <min>0.2</min>\r\n        <max>100.0</max>\r\n        <resolution>0.01</resolution>\r\n      </range>\r\n    </ray>\r\n    <plugin name="velodyne_controller" filename="libgazebo_ros_ray_sensor.so">\r\n      <ros>\r\n        <namespace>/velodyne</namespace>\r\n      </ros>\r\n      <output_type>sensor_msgs/PointCloud2</output_type>\r\n      <frame_name>velodyne_link</frame_name>\r\n    </plugin>\r\n  </sensor>\r\n</gazebo>\n'})}),"\n",(0,i.jsx)(e.h3,{id:"lidar-parameters",children:"LiDAR Parameters"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"samples"}),": Number of laser rays"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"min_angle/max_angle"}),": Angular range"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"min/max range"}),": Distance limits"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"update_rate"}),": Scan frequency"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"imu-sensors",children:"IMU Sensors"}),"\n",(0,i.jsx)(e.p,{children:"IMU (Inertial Measurement Unit) sensors measure acceleration and angular velocity."}),"\n",(0,i.jsx)(e.h3,{id:"imu-configuration",children:"IMU Configuration"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<gazebo reference="imu_link">\r\n  <sensor name="imu_sensor" type="imu">\r\n    <plugin filename="libgazebo_ros_imu_sensor.so" name="imu_plugin">\r\n      <ros>\r\n        <namespace>/imu</namespace>\r\n      </ros>\r\n      <initial_orientation_as_reference>false</initial_orientation_as_reference>\r\n    </plugin>\r\n    <always_on>true</always_on>\r\n    <update_rate>100</update_rate>\r\n    <visualize>true</visualize>\r\n    <imu>\r\n      <angular_velocity>\r\n        <x>\r\n          <noise type="gaussian">\r\n            <mean>0.0</mean>\r\n            <stddev>2e-4</stddev>\r\n            <bias_mean>0.0000075</bias_mean>\r\n            <bias_stddev>0.0000008</bias_stddev>\r\n          </noise>\r\n        </x>\r\n        <y>\r\n          <noise type="gaussian">\r\n            <mean>0.0</mean>\r\n            <stddev>2e-4</stddev>\r\n            <bias_mean>0.0000075</bias_mean>\r\n            <bias_stddev>0.0000008</bias_stddev>\r\n          </noise>\r\n        </y>\r\n        <z>\r\n          <noise type="gaussian">\r\n            <mean>0.0</mean>\r\n            <stddev>2e-4</stddev>\r\n            <bias_mean>0.0000075</bias_mean>\r\n            <bias_stddev>0.0000008</bias_stddev>\r\n          </noise>\r\n        </z>\r\n      </angular_velocity>\r\n      <linear_acceleration>\r\n        <x>\r\n          <noise type="gaussian">\r\n            <mean>0.0</mean>\r\n            <stddev>1.7e-2</stddev>\r\n            <bias_mean>0.1</bias_mean>\r\n            <bias_stddev>0.001</bias_stddev>\r\n          </noise>\r\n        </x>\r\n        <y>\r\n          <noise type="gaussian">\r\n            <mean>0.0</mean>\r\n            <stddev>1.7e-2</stddev>\r\n            <bias_mean>0.1</bias_mean>\r\n            <bias_stddev>0.001</bias_stddev>\r\n          </noise>\r\n        </y>\r\n        <z>\r\n          <noise type="gaussian">\r\n            <mean>0.0</mean>\r\n            <stddev>1.7e-2</stddev>\r\n            <bias_mean>0.1</bias_mean>\r\n            <bias_stddev>0.001</bias_stddev>\r\n          </noise>\r\n        </z>\r\n      </linear_acceleration>\r\n    </imu>\r\n  </sensor>\r\n</gazebo>\n'})}),"\n",(0,i.jsx)(e.h2,{id:"noise-models",children:"Noise Models"}),"\n",(0,i.jsx)(e.p,{children:"Real sensors have noise. Adding realistic noise to simulated sensors makes algorithms more robust."}),"\n",(0,i.jsx)(e.h3,{id:"noise-types",children:"Noise Types"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-mermaid",children:"graph TB\r\n    A[Noise Models] --\x3e B[Gaussian]\r\n    A --\x3e C[Uniform]\r\n    A --\x3e D[Custom]\r\n    \r\n    B --\x3e B1[Most common]\r\n    B --\x3e B2[Realistic]\r\n    \r\n    C --\x3e C1[Simple]\r\n    \r\n    D --\x3e D1[User-defined]\r\n    \r\n    style B fill:#c8e6c9\n"})}),"\n",(0,i.jsx)(e.h3,{id:"gaussian-noise",children:"Gaussian Noise"}),"\n",(0,i.jsx)(e.p,{children:"Most common noise model, based on normal distribution:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<noise type="gaussian">\r\n  <mean>0.0</mean>           \x3c!-- Mean value --\x3e\r\n  <stddev>0.01</stddev>      \x3c!-- Standard deviation --\x3e\r\n  <bias_mean>0.0</bias_mean> \x3c!-- Bias mean --\x3e\r\n  <bias_stddev>0.001</bias_stddev> \x3c!-- Bias std dev --\x3e\r\n</noise>\n'})}),"\n",(0,i.jsx)(e.h3,{id:"noise-parameters",children:"Noise Parameters"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"mean"}),": Average noise value (usually 0)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"stddev"}),": Standard deviation (noise magnitude)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"bias_mean"}),": Average sensor bias"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"bias_stddev"}),": Bias variation"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"adding-noise-to-camera",children:"Adding Noise to Camera"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<sensor type="camera" name="noisy_camera">\r\n  <camera name="head">\r\n    \x3c!-- Camera config --\x3e\r\n  </camera>\r\n  <noise>\r\n    <type>gaussian</type>\r\n    <mean>0.0</mean>\r\n    <stddev>0.007</stddev>  \x3c!-- Image noise --\x3e\r\n  </noise>\r\n</sensor>\n'})}),"\n",(0,i.jsx)(e.h3,{id:"adding-noise-to-lidar",children:"Adding Noise to LiDAR"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<sensor type="ray" name="noisy_lidar">\r\n  <ray>\r\n    <scan>\r\n      <horizontal>\r\n        <samples>720</samples>\r\n      </horizontal>\r\n    </scan>\r\n    <range>\r\n      <min>0.1</min>\r\n      <max>30.0</max>\r\n    </range>\r\n  </ray>\r\n  <noise>\r\n    <type>gaussian</type>\r\n    <mean>0.0</mean>\r\n    <stddev>0.01</stddev>  \x3c!-- Range noise in meters --\x3e\r\n  </noise>\r\n</sensor>\n'})}),"\n",(0,i.jsx)(e.h2,{id:"sensor-data-in-ros-2",children:"Sensor Data in ROS 2"}),"\n",(0,i.jsx)(e.h3,{id:"camera-topics",children:"Camera Topics"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# Image topic\r\n/camera/image_raw          # sensor_msgs/Image\r\n/camera/camera_info        # sensor_msgs/CameraInfo\r\n\r\n# Compressed image\r\n/camera/image_raw/compressed  # sensor_msgs/CompressedImage\n"})}),"\n",(0,i.jsx)(e.h3,{id:"lidar-topics",children:"LiDAR Topics"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# 2D LiDAR\r\n/lidar/scan                # sensor_msgs/LaserScan\r\n\r\n# 3D LiDAR\r\n/velodyne/points           # sensor_msgs/PointCloud2\n"})}),"\n",(0,i.jsx)(e.h3,{id:"imu-topics",children:"IMU Topics"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"/imu/data                  # sensor_msgs/Imu\r\n/imu/magnetic_field        # sensor_msgs/MagneticField (if available)\n"})}),"\n",(0,i.jsx)(e.h3,{id:"subscribing-to-sensor-data",children:"Subscribing to Sensor Data"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'#!/usr/bin/env python3\r\n"""\r\nSensor Data Subscriber\r\n\r\nSubscribes to camera, LiDAR, and IMU data.\r\n"""\r\n\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom sensor_msgs.msg import Image, LaserScan, Imu, PointCloud2\r\nfrom cv_bridge import CvBridge\r\nimport cv2\r\n\r\n\r\nclass SensorSubscriber(Node):\r\n    def __init__(self):\r\n        super().__init__(\'sensor_subscriber\')\r\n        \r\n        # Camera subscriber\r\n        self.camera_sub = self.create_subscription(\r\n            Image,\r\n            \'/camera/image_raw\',\r\n            self.camera_callback,\r\n            10\r\n        )\r\n        \r\n        # LiDAR subscriber\r\n        self.lidar_sub = self.create_subscription(\r\n            LaserScan,\r\n            \'/lidar/scan\',\r\n            self.lidar_callback,\r\n            10\r\n        )\r\n        \r\n        # IMU subscriber\r\n        self.imu_sub = self.create_subscription(\r\n            Imu,\r\n            \'/imu/data\',\r\n            self.imu_callback,\r\n            10\r\n        )\r\n        \r\n        # CV Bridge for image conversion\r\n        self.bridge = CvBridge()\r\n        \r\n        self.get_logger().info(\'Sensor subscriber started\')\r\n    \r\n    def camera_callback(self, msg):\r\n        """Process camera image."""\r\n        try:\r\n            # Convert ROS image to OpenCV\r\n            cv_image = self.bridge.imgmsg_to_cv2(msg, "bgr8")\r\n            \r\n            # Process image (example: show it)\r\n            cv2.imshow("Camera View", cv_image)\r\n            cv2.waitKey(1)\r\n            \r\n            self.get_logger().info(f\'Received image: {msg.width}x{msg.height}\')\r\n        except Exception as e:\r\n            self.get_logger().error(f\'Error processing image: {e}\')\r\n    \r\n    def lidar_callback(self, msg):\r\n        """Process LiDAR scan."""\r\n        # Get ranges\r\n        ranges = msg.ranges\r\n        \r\n        # Find minimum distance\r\n        valid_ranges = [r for r in ranges if r > msg.range_min and r < msg.range_max]\r\n        if valid_ranges:\r\n            min_dist = min(valid_ranges)\r\n            self.get_logger().info(f\'Minimum distance: {min_dist:.2f}m\')\r\n    \r\n    def imu_callback(self, msg):\r\n        """Process IMU data."""\r\n        # Linear acceleration\r\n        accel = msg.linear_acceleration\r\n        # Angular velocity\r\n        angular = msg.angular_velocity\r\n        \r\n        self.get_logger().info(\r\n            f\'Accel: [{accel.x:.2f}, {accel.y:.2f}, {accel.z:.2f}], \'\r\n            f\'Angular: [{angular.x:.2f}, {angular.y:.2f}, {angular.z:.2f}]\'\r\n        )\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = SensorSubscriber()\r\n    \r\n    try:\r\n        rclpy.spin(node)\r\n    except KeyboardInterrupt:\r\n        node.get_logger().info(\'Shutting down...\')\r\n    finally:\r\n        node.destroy_node()\r\n        rclpy.shutdown()\r\n\r\n\r\nif __name__ == \'__main__\':\r\n    main()\n'})}),"\n",(0,i.jsx)(e.h2,{id:"visualization-in-rviz2",children:"Visualization in RViz2"}),"\n",(0,i.jsx)(e.p,{children:"RViz2 is the visualization tool for ROS 2. It can display all sensor data types."}),"\n",(0,i.jsx)(e.h3,{id:"launching-rviz2",children:"Launching RViz2"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# Basic launch\r\nrviz2\r\n\r\n# With configuration\r\nrviz2 -d my_config.rviz\n"})}),"\n",(0,i.jsx)(e.h3,{id:"display-types",children:"Display Types"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Image"}),": Camera feeds"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"LaserScan"}),": 2D LiDAR visualization"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"PointCloud2"}),": 3D point clouds"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Imu"}),": IMU data visualization"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"TF"}),": Coordinate frame visualization"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"RobotModel"}),": Robot model visualization"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"rviz2-configuration",children:"RViz2 Configuration"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:'# my_config.rviz\r\nPanels:\r\n  - Class: rviz_common/Displays\r\n    Name: Displays\r\n  - Class: rviz_common/Selection\r\n    Name: Selection\r\n  - Class: rviz_common/Tool Properties\r\n    Name: Tool Properties\r\n  - Class: rviz_common/Views\r\n    Name: Views\r\n\r\nVisualization Manager:\r\n  Class: ""\r\n  Displays:\r\n    - Alpha: 0.5\r\n      Cell Size: 1\r\n      Class: rviz_default_plugins/Grid\r\n      Name: Grid\r\n      Value: true\r\n    - Class: rviz_default_plugins/Image\r\n      Image Topic: /camera/image_raw\r\n      Name: Camera\r\n      Value: true\r\n    - Class: rviz_default_plugins/LaserScan\r\n      Laser Scan Topic: /lidar/scan\r\n      Name: LiDAR\r\n      Value: true\r\n    - Class: rviz_default_plugins/PointCloud2\r\n      Point Cloud Topic: /velodyne/points\r\n      Name: PointCloud\r\n      Value: true\r\n    - Class: rviz_default_plugins/Imu\r\n      Imu Topic: /imu/data\r\n      Name: IMU\r\n      Value: true\r\n    - Class: rviz_default_plugins/RobotModel\r\n      Name: RobotModel\r\n      Robot Description: robot_description\r\n      Value: true\r\n  Global Options:\r\n    Background Color: 48 48 48\r\n    Fixed Frame: base_link\r\n  Value: true\n'})}),"\n",(0,i.jsx)(e.h2,{id:"complete-sensor-suite-example",children:"Complete Sensor Suite Example"}),"\n",(0,i.jsx)(e.p,{children:"Here's a complete robot with all sensors:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0"?>\r\n<robot name="sensor_robot">\r\n  \x3c!-- Base Link --\x3e\r\n  <link name="base_link">\r\n    <visual>\r\n      <geometry>\r\n        <box size="0.4 0.3 0.2"/>\r\n      </geometry>\r\n    </visual>\r\n    <collision>\r\n      <geometry>\r\n        <box size="0.4 0.3 0.2"/>\r\n      </geometry>\r\n    </collision>\r\n    <inertial>\r\n      <mass value="5.0"/>\r\n      <inertia ixx="0.1" ixy="0" ixz="0"\r\n               iyy="0.1" iyz="0" izz="0.1"/>\r\n    </inertial>\r\n  </link>\r\n  \r\n  \x3c!-- Camera Link --\x3e\r\n  <link name="camera_link">\r\n    <visual>\r\n      <geometry>\r\n        <box size="0.05 0.05 0.05"/>\r\n      </geometry>\r\n    </visual>\r\n    <inertial>\r\n      <mass value="0.1"/>\r\n      <inertia ixx="0.001" ixy="0" ixz="0"\r\n               iyy="0.001" iyz="0" izz="0.001"/>\r\n    </inertial>\r\n  </link>\r\n  \r\n  <joint name="camera_joint" type="fixed">\r\n    <parent link="base_link"/>\r\n    <child link="camera_link"/>\r\n    <origin xyz="0.2 0 0.1" rpy="0 0 0"/>\r\n  </joint>\r\n  \r\n  \x3c!-- LiDAR Link --\x3e\r\n  <link name="lidar_link">\r\n    <visual>\r\n      <geometry>\r\n        <cylinder radius="0.05" length="0.1"/>\r\n      </geometry>\r\n    </visual>\r\n    <inertial>\r\n      <mass value="0.2"/>\r\n      <inertia ixx="0.001" ixy="0" ixz="0"\r\n               iyy="0.001" iyz="0" izz="0.001"/>\r\n    </inertial>\r\n  </link>\r\n  \r\n  <joint name="lidar_joint" type="fixed">\r\n    <parent link="base_link"/>\r\n    <child link="lidar_link"/>\r\n    <origin xyz="0 0 0.15" rpy="0 0 0"/>\r\n  </joint>\r\n  \r\n  \x3c!-- IMU Link --\x3e\r\n  <link name="imu_link">\r\n    <visual>\r\n      <geometry>\r\n        <box size="0.02 0.02 0.02"/>\r\n      </geometry>\r\n    </visual>\r\n    <inertial>\r\n      <mass value="0.01"/>\r\n      <inertia ixx="0.0001" ixy="0" ixz="0"\r\n               iyy="0.0001" iyz="0" izz="0.0001"/>\r\n    </inertial>\r\n  </link>\r\n  \r\n  <joint name="imu_joint" type="fixed">\r\n    <parent link="base_link"/>\r\n    <child link="imu_link"/>\r\n    <origin xyz="0 0 0" rpy="0 0 0"/>\r\n  </joint>\r\n  \r\n  \x3c!-- Gazebo Plugins --\x3e\r\n  <gazebo reference="camera_link">\r\n    <sensor type="camera" name="camera1">\r\n      <update_rate>30</update_rate>\r\n      <camera name="head">\r\n        <horizontal_fov>1.047</horizontal_fov>\r\n        <image>\r\n          <width>640</width>\r\n          <height>480</height>\r\n          <format>R8G8B8</format>\r\n        </image>\r\n        <clip>\r\n          <near>0.02</near>\r\n          <far>300</far>\r\n        </clip>\r\n      </camera>\r\n      <plugin name="camera_controller" filename="libgazebo_ros_camera.so">\r\n        <ros>\r\n          <namespace>/camera</namespace>\r\n        </ros>\r\n        <camera_name>camera</camera_name>\r\n        <frame_name>camera_link</frame_name>\r\n      </plugin>\r\n    </sensor>\r\n  </gazebo>\r\n  \r\n  <gazebo reference="lidar_link">\r\n    <sensor type="ray" name="head_lidar">\r\n      <pose>0 0 0 0 0 0</pose>\r\n      <visualize>false</visualize>\r\n      <update_rate>40</update_rate>\r\n      <ray>\r\n        <scan>\r\n          <horizontal>\r\n            <samples>720</samples>\r\n            <resolution>1</resolution>\r\n            <min_angle>-3.14159</min_angle>\r\n            <max_angle>3.14159</max_angle>\r\n          </horizontal>\r\n        </scan>\r\n        <range>\r\n          <min>0.10</min>\r\n          <max>30.0</max>\r\n          <resolution>0.01</resolution>\r\n        </range>\r\n      </ray>\r\n      <plugin name="gazebo_ros_lidar_controller" filename="libgazebo_ros_ray_sensor.so">\r\n        <ros>\r\n          <namespace>/lidar</namespace>\r\n        </ros>\r\n        <output_type>sensor_msgs/LaserScan</output_type>\r\n        <frame_name>lidar_link</frame_name>\r\n      </plugin>\r\n    </sensor>\r\n  </gazebo>\r\n  \r\n  <gazebo reference="imu_link">\r\n    <sensor name="imu_sensor" type="imu">\r\n      <plugin filename="libgazebo_ros_imu_sensor.so" name="imu_plugin">\r\n        <ros>\r\n          <namespace>/imu</namespace>\r\n        </ros>\r\n        <initial_orientation_as_reference>false</initial_orientation_as_reference>\r\n      </plugin>\r\n      <always_on>true</always_on>\r\n      <update_rate>100</update_rate>\r\n      <visualize>true</visualize>\r\n      <imu>\r\n        <angular_velocity>\r\n          <x>\r\n            <noise type="gaussian">\r\n              <mean>0.0</mean>\r\n              <stddev>2e-4</stddev>\r\n            </noise>\r\n          </x>\r\n          <y>\r\n            <noise type="gaussian">\r\n              <mean>0.0</mean>\r\n              <stddev>2e-4</stddev>\r\n            </noise>\r\n          </y>\r\n          <z>\r\n            <noise type="gaussian">\r\n              <mean>0.0</mean>\r\n              <stddev>2e-4</stddev>\r\n            </noise>\r\n          </z>\r\n        </angular_velocity>\r\n        <linear_acceleration>\r\n          <x>\r\n            <noise type="gaussian">\r\n              <mean>0.0</mean>\r\n              <stddev>1.7e-2</stddev>\r\n            </noise>\r\n          </x>\r\n          <y>\r\n            <noise type="gaussian">\r\n              <mean>0.0</mean>\r\n              <stddev>1.7e-2</stddev>\r\n            </noise>\r\n          </y>\r\n          <z>\r\n            <noise type="gaussian">\r\n              <mean>0.0</mean>\r\n              <stddev>1.7e-2</stddev>\r\n            </noise>\r\n          </z>\r\n        </linear_acceleration>\r\n      </imu>\r\n    </sensor>\r\n  </gazebo>\r\n</robot>\n'})}),"\n",(0,i.jsx)(e.h2,{id:"common-pitfalls",children:"Common Pitfalls"}),"\n",(0,i.jsx)(e.h3,{id:"pitfall-1-sensor-not-publishing",children:"Pitfall 1: Sensor Not Publishing"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Problem"}),": Sensor data not appearing in ROS 2 topics."]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Check plugin filename is correct"}),"\n",(0,i.jsx)(e.li,{children:"Verify frame names match"}),"\n",(0,i.jsx)(e.li,{children:"Check sensor update rate"}),"\n",(0,i.jsx)(e.li,{children:"Ensure Gazebo is running"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"pitfall-2-wrong-coordinate-frame",children:"Pitfall 2: Wrong Coordinate Frame"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Problem"}),": Sensor data in wrong frame."]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Solution"}),": Set correct frame_name in plugin configuration."]}),"\n",(0,i.jsx)(e.h3,{id:"pitfall-3-too-high-update-rate",children:"Pitfall 3: Too High Update Rate"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Problem"}),": Simulation slows down."]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Solution"}),": Reduce sensor update rates to reasonable values (10-30 Hz for cameras, 40 Hz for LiDAR)."]}),"\n",(0,i.jsx)(e.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsx)(e.p,{children:"Continue learning:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"/physical-ai-textbook/docs/module-02-simulation/unity-integration",children:"Chapter 5: Unity Integration"})," - High-fidelity rendering"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"/physical-ai-textbook/docs/module-02-simulation/practical-lab",children:"Chapter 6: Practical Lab"})," - Build complete humanoid simulation"]}),"\n"]})]})}function c(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>o,x:()=>l});var a=r(6540);const i={},s=a.createContext(i);function o(n){const e=a.useContext(s);return a.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:o(n.components),a.createElement(s.Provider,{value:e},n.children)}}}]);